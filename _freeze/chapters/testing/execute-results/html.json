{
  "hash": "9fe70eb7af9ca7c6941c5239b3ed9afd",
  "result": {
    "markdown": "# Answering questions\n\nWe have been preparing and analysing our data to answer our questions. In\nthis case we have two: \n\n1. Is there any difference between treatment and control in the wild type (WT)\ncondition?\n2. Does the effect of treatment depends on genotype? \n\nThe questions will be answered in the next section by using the framework\nof linear regression. Linear regression is doing almost the same thing\nas a t-test. Also if you want to test normality of the\nvalues this is possible, but since the sample size is very low it is \nvery difficult to reject the null hypothesis that the samples do not \nfollow a normal distribution. \n\nThe regression framework allows us to extend it to other uses, such as \nusing other types of distributions. One example is when we are dealing\nwith proportions or percentages, usually one would use the \ngamma distribution instead of the normal distribution to model\nthe data. \n\nLet's move to answering the questions! \n\n## First question\n\nLet us recap the question here:\n\n> Is there any difference between treatment and control in the wild type (WT)\ncondition?\n\nFor this we will need to load once again the packages and our previous\ncheckpoint. R already provides in the base package the function `lm` \nto perform linear regression, so this is actually not necessary to load.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(broom)\n\n# we load only the normalized data as this is what will be used when doing\n# the comparisons\nnormalized_qpcr <- readRDS(\"../checkpoints/normalizing/normalized_qpcr.rds\")\n```\n:::\n\n\nThe code below executes the comparison and prints the output. What we want\nto read from the linear regression output is the estimate of the \nslope, that will represent the difference between the two groups! One nice\nthing of using linear regression is that you get the difference values between\nyour conditions, and that might be used to further interpret the results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalysis_first_question <- normalized_qpcr %>% \n    # first filter just for the WT\n    dplyr::filter(grepl(\"WT\", group)) %>%\n    # Now we factor so the first level is control and the difference\n    # then represents treatment - control.\n    dplyr::mutate(group = factor(group, levels = c(\"WT C\", \"WT T\"))) %>%\n    # perform the linear regression\n    lm(dct ~ group, data = .) %>%\n    # tidy up the results so we can display\n    broom::tidy()\n    \n\nanalysis_first_question %>% \n    kableExtra::kbl() %>%\n    kableExtra::kable_classic(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -0.5433333 </td>\n   <td style=\"text-align:right;\"> 0.1028963 </td>\n   <td style=\"text-align:right;\"> -5.280396 </td>\n   <td style=\"text-align:right;\"> 0.0061685 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> groupWT T </td>\n   <td style=\"text-align:right;\"> 1.1077778 </td>\n   <td style=\"text-align:right;\"> 0.1455174 </td>\n   <td style=\"text-align:right;\"> 7.612684 </td>\n   <td style=\"text-align:right;\"> 0.0015982 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nTo calculate the fold change one needs to flip the sign for the \nestimate, since an increase of CT is actually a decrease in expression.\nThe total fold change is 0.4640082 and\nlog fold change is -1.1077778.\n\nThe way to calculate the fold change is $2^{(-\\text{estimate})}$, where\n$\\text{estimate}$ corresponds to the second row and second column of the \ntable above. And the log fold change is just the negative value of \n$\\text{estimate}$. \n\nThe conclusion for this question is that there is indeed a decrease in\nAKT expression levels in the treated condition for the WT genotype. We had\nalready seen this from the plots of the previous chapters.\n\nI would recommend to report this values along with the previous plots,\nas the CT values are also an important aspect of the analysis, as an\nincrease of 30 to 31 is not the same as 16 to 17. \n\n## Second question\n\nWe now move on to the second question.\n\n> Does the effect of treatment depends on genotype? \n\nHere we are interested in the interaction between the genotype and treatment.\nR has an special way to encode this when doing linear regression, by using\nthe star symbol \\*. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalysis_second_question <- normalized_qpcr %>% \n    dplyr::mutate(\n        group = factor(group, levels = c(\"WT C\", \"WT T\", \"KO C\", \"KO T\")),\n        genotype = factor(genotype, levels = c(\"WT\", \"KO\"))\n    ) %>%\n    # notice here the star. we are now interested in the interaction\n    lm(dct ~ genotype * treatment, data = .) %>%\n    broom::tidy()\n    \nanalysis_second_question %>% \n    kableExtra::kbl() %>%\n    kableExtra::kable_classic(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -0.5433333 </td>\n   <td style=\"text-align:right;\"> 0.4440748 </td>\n   <td style=\"text-align:right;\"> -1.2235175 </td>\n   <td style=\"text-align:right;\"> 0.2559465 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> genotypeKO </td>\n   <td style=\"text-align:right;\"> 0.9066667 </td>\n   <td style=\"text-align:right;\"> 0.6280167 </td>\n   <td style=\"text-align:right;\"> 1.4436984 </td>\n   <td style=\"text-align:right;\"> 0.1868167 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> treatmentT </td>\n   <td style=\"text-align:right;\"> 1.1077778 </td>\n   <td style=\"text-align:right;\"> 0.6280167 </td>\n   <td style=\"text-align:right;\"> 1.7639305 </td>\n   <td style=\"text-align:right;\"> 0.1157518 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> genotypeKO:treatmentT </td>\n   <td style=\"text-align:right;\"> -0.3388889 </td>\n   <td style=\"text-align:right;\"> 0.8881497 </td>\n   <td style=\"text-align:right;\"> -0.3815673 </td>\n   <td style=\"text-align:right;\"> 0.7127173 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWe had already seen that actually in the knockout condition there was\na lot of variability. This is reflected in the results here. The last line\nof the table above presents the result that interest us, the interaction\nbetween treatment and genotype. We see that the p-value is around 0.71,\nso we don't have enough evidence to reject the null hypothesis, which is \nthere is no effect in the genotype and treatment. \n\n# Conclusion\n\nHere we saw how to perform basic statistical analysis of the generated\nqPCR data and how to interpret it. The analysis does not stop here,\nit is important to also document it. In the next chapter we show a\nresource that will teach you how to generate such report and how\nyou can customize it.\n",
    "supporting": [
      "testing_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}