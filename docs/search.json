[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "An (opinionated) introduction to R for biologists",
    "section": "",
    "text": "For a more gentle introduction to R and its basics, check the book Hands-On Programming with R.\nIf you are familiar with R already and want to go deeper with the tidyverse functions, take a look at the book R for Data Science."
  },
  {
    "objectID": "chapters/loading.html",
    "href": "chapters/loading.html",
    "title": "2  Loading your data",
    "section": "",
    "text": "The first step in any data analysis is to open up your favorite software and load the data up. You are probably familiar with user interfaces, where you click some buttons, you upload your excel file and voilá, data is ready to analyse.\nIn this chapter I will teach you how to format your qPCR data so you can load it easily to R. I will also show you how to load the data itself."
  },
  {
    "objectID": "chapters/loading.html#formats-formats-and-more-formats",
    "href": "chapters/loading.html#formats-formats-and-more-formats",
    "title": "2  Loading your data",
    "section": "2.1 Formats, formats and more formats…",
    "text": "2.1 Formats, formats and more formats…\nIf you are here, you are probably used to excel and the format xlsx. R can open these files, however, it is easier to run your analysis if you have your data in the csv format. For qPCR specially, each qPCR machine, the excel sheet will be different and not in a standard format. Usually it is a table with several cells containing information regarding your run and other parameters.\nGiven your fresh table from the qPCR machine, we will extract some columns. In qPCR experiments, usually there are three technical replicates for your samples. This is reflected in how the data is saved.\nAn example table is shown in the data folder."
  },
  {
    "objectID": "chapters/loading.html#how-to-load-your-data",
    "href": "chapters/loading.html#how-to-load-your-data",
    "title": "2  Loading your data",
    "section": "2.2 How to load your data",
    "text": "2.2 How to load your data\nIf you saved your table as a csv file, then we have several options to load the file. You can use the function read.csv or read.table from base R to open the tables. The way to use these functions is shown below.\n\nqpcr <- read.csv(\"../data/qPCR.csv\")\nqpcr <- read.table(\"../data/qPCR.csv\", sep = \",\", header = TRUE)\n\nNote that for read.table we need to specify the separator, in this case it is a comma (“,”) and we also specify HEADER = TRUE. This means the first row of your table is the header of your data frame. In general if you have a csv file, it is easier to run read.csv."
  },
  {
    "objectID": "chapters/loading.html#checking-the-data",
    "href": "chapters/loading.html#checking-the-data",
    "title": "2  Loading your data",
    "section": "2.3 Checking the data",
    "text": "2.3 Checking the data\nWhen loading the data, it is very important to check if it was imported successfully or any problem happened. A package that we will be using throughout this book is dplyr. Within dplyr we have some functions that help us deal data frames in a very intuitive way. The first function we will use here to check the data is glimpse. We load the package here, but it is best practice to load all the packages you will be using at the beginning of your analysis.\n\n# we now use the function glimpse on our dataframe\nglimpse(qpcr)\n\nRows: 72\nColumns: 4\n$ sample_id <int> 20, 20, 20, 21, 21, 21, 22, 22, 22, 23, 23, 23, 24, 24, 24, …\n$ group     <chr> \"WT C\", \"WT C\", \"WT C\", \"WT C\", \"WT C\", \"WT C\", \"WT C\", \"WT …\n$ gene      <chr> \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT…\n$ ct        <dbl> 16.49, 16.44, 16.65, 16.50, 16.74, 16.68, 16.96, 16.92, 17.0…\n\n\nThe function glimpse displays a summary of each column of your dataframe and their data types. We see that sample_id is an integer, group and gene are characters and finally the ct values are doubles, meaning they are numeric. So far the data looks good.\nAnother way to use the function glimpse and other functions from the dplyr package is using the pipe %>%. The way to interpret the pipe is the following. Given a dataframe, we pipe the dataframe to the next function. The syntax is shown in the code block below.\n\nqpcr %>% glimpse\n\nRows: 72\nColumns: 4\n$ sample_id <int> 20, 20, 20, 21, 21, 21, 22, 22, 22, 23, 23, 23, 24, 24, 24, …\n$ group     <chr> \"WT C\", \"WT C\", \"WT C\", \"WT C\", \"WT C\", \"WT C\", \"WT C\", \"WT …\n$ gene      <chr> \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT\", \"AKT…\n$ ct        <dbl> 16.49, 16.44, 16.65, 16.50, 16.74, 16.68, 16.96, 16.92, 17.0…\n\n\nThe output is the same as before, the difference is that we can use other functions and chain them together. For example, if we want to see only the first 5 rows of the table and then select the row with maximum ct value, we can use the function head followed by slice_max.\n\nqpcr %>% \n    head %>%\n    slice_max(order_by = ct) # specify the column by passing the name without quotes\n\n  sample_id group gene    ct\n1        21  WT C  AKT 16.74\n\n\nThere is a flow of code when chaining functions like this. By also writing code like this, it is easier to modify or add new steps to the chain."
  },
  {
    "objectID": "chapters/loading.html#checkpoint",
    "href": "chapters/loading.html#checkpoint",
    "title": "2  Loading your data",
    "section": "2.4 Checkpoint",
    "text": "2.4 Checkpoint\nWe now use readRDS to save our current matrix to load it up in the next chapter. The checkpoints are not necessary. As this is a simple analysis, you can run everything in a single script and loaded in your memory. The good thing about checkpoints is that you can save heavy calculations so you do not need to perform them again.\n\nsaveRDS(qpcr, \"../checkpoints/loading/qpcr.rds\")\n\n\n\n\n\n\n\nTip\n\n\n\nreadRDS is a function that lets you save R objects into your computer. It is extremely handy when you want to save expensive calculations or continue your analysis later. Note you are only saving one object.\n\n\n\n\n\n\n\n\nTip\n\n\n\nIf you are using quarto markdown or Rmarkdown, there is a chunk option that you can use to not rerun that chunk, namely the cache option.\n\n\nFor each checkpoint, we save them in a specific folder for each chapter inside checkpoints, in the root folder. This ensures we know where the data was generated by pointing to the name of the chapter."
  },
  {
    "objectID": "chapters/cleaning.html",
    "href": "chapters/cleaning.html",
    "title": "3  Cleaning your data",
    "section": "",
    "text": "In this chapter we will go over how you can clean your data before you start any analysis. Doing this before anything else will save you a lot of time. It is very frequent that you need to change a variable name or create a new column in your dataframe. By performing the cleaning and modifications before doing any plotting, it helps to ensure you will be using clean data and it will make your life easier."
  },
  {
    "objectID": "chapters/cleaning.html#loading-libraries-and-files",
    "href": "chapters/cleaning.html#loading-libraries-and-files",
    "title": "3  Cleaning your data",
    "section": "3.1 Loading libraries and files",
    "text": "3.1 Loading libraries and files\nAs discussed before, we start by loading the libraries we will use. In this section we will go over the packages janitor, stringr and tidyr.\n\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(janitor)\nlibrary(tidyr)\n\nAnd we load up our qPCR data saved from the checkpoint. To do this we use the function readRDS. For this we only specify the path to where the checkpoint was saved.\n\nqpcr <- readRDS(\"../checkpoints/loading/qpcr.rds\")"
  },
  {
    "objectID": "chapters/cleaning.html#formatting-your-column-names",
    "href": "chapters/cleaning.html#formatting-your-column-names",
    "title": "3  Cleaning your data",
    "section": "3.2 Formatting your column names",
    "text": "3.2 Formatting your column names\nWhenever doing analysis on R it is important to have sound column names. They make data wrangling easier. Moreover, when you repeat the analysis over and over again, having sane names for your columns makes your code cleaner. There is a very neat package in R that helps cleaning your column names and suggesting new names: janitor. In this package there is the function clean_names that changes all column names to lower case, change spaces and dots to underscores and much more. The idea is that you have very clear names without any non conventional character.\nThe qPCR dataframe has the following columns:\n\ncolnames(qpcr)\n\n[1] \"sample.ID\" \"group\"     \"gene\"      \"ct\"       \n\n\nThe column sample.ID has both lower and upper case. This does not help when referencing and makes reading more difficult.\n\nqpcr <- qpcr %>% janitor::clean_names()\n\ncolnames(qpcr)\n\n[1] \"sample_id\" \"group\"     \"gene\"      \"ct\"       \n\n\nThe column was changed from sample.ID to sample_id."
  },
  {
    "objectID": "chapters/cleaning.html#changing-values-in-a-column",
    "href": "chapters/cleaning.html#changing-values-in-a-column",
    "title": "3  Cleaning your data",
    "section": "3.3 Changing values in a column",
    "text": "3.3 Changing values in a column\nWe saw previously that the column group contains the knockout and treatment assignments. This would be better if it was in different columns. Notice that these two information are separated by a space in the group column. To split them, we use the function separate from tidyr.\n\nqpcr <- qpcr %>% \n    # set the argument remove to FALSE so the column is not removed\n    # from the dataframe\n    separate(col = \"group\", into = c(\"genotype\", \"treatment\"), remove = FALSE)\n\nqpcr %>% head\n\n  sample_id group genotype treatment gene    ct\n1        20  WT C       WT         C  AKT 16.49\n2        20  WT C       WT         C  AKT 16.44\n3        20  WT C       WT         C  AKT 16.65\n4        21  WT C       WT         C  AKT 16.50\n5        21  WT C       WT         C  AKT 16.74\n6        21  WT C       WT         C  AKT 16.68\n\n\nNote that the samples have an ID, and they are represented by integers. Actually it would be better if this columns is represented by factors. This is actually very important when doing linear modelling. If a column is numeric, or integers, R will estimate the parameters as if the variable is continuous, whereas it should be a group for example.\nTo modify one column we can use the function mutate from dplyr. We use the function factor to convert a numeric vector into a categorical vector.\n\nqpcr <- qpcr %>%\n    mutate(sample_id = factor(sample_id))\n\nclass(qpcr[, \"sample_id\"])\n\n[1] \"factor\""
  },
  {
    "objectID": "chapters/cleaning.html#checkpoint",
    "href": "chapters/cleaning.html#checkpoint",
    "title": "3  Cleaning your data",
    "section": "3.4 Checkpoint",
    "text": "3.4 Checkpoint\nWe are ready to proceed to the next steps. Before that we save once again our data. You can either overwrite or create a new object. For the sake of clarity, we always save a new object. Sometimes this is not useful because the objects are big, so you want to actually overwrite the previous rds object.\n\nsaveRDS(qpcr, \"../checkpoints/cleaning/qpcr.rds\")"
  },
  {
    "objectID": "chapters/preparing.html",
    "href": "chapters/preparing.html",
    "title": "4  Preparing the data",
    "section": "",
    "text": "Describe data needs to be in special format to do stuff in R, explain pivoting. Explain groupping as well, which makes it easier to do average calculations"
  },
  {
    "objectID": "chapters/preparing.html#loading-libraries-and-files",
    "href": "chapters/preparing.html#loading-libraries-and-files",
    "title": "4  Preparing the data",
    "section": "4.1 Loading libraries and files",
    "text": "4.1 Loading libraries and files\n\nlibrary(dplyr)\nlibrary(tidyr)\n\nqpcr <- readRDS(\"../checkpoints/cleaning/qpcr.rds\")"
  },
  {
    "objectID": "chapters/preparing.html#pivoting",
    "href": "chapters/preparing.html#pivoting",
    "title": "4  Preparing the data",
    "section": "4.2 Pivoting",
    "text": "4.2 Pivoting\n\nexplain pivoting and why it is useful. mention plotting and filtering"
  },
  {
    "objectID": "chapters/preparing.html#grouping-data",
    "href": "chapters/preparing.html#grouping-data",
    "title": "4  Preparing the data",
    "section": "4.3 Grouping data",
    "text": "4.3 Grouping data\n\nexplain the use of group_by from dplyr. show how useful it is by summarizing and filtering based on groups."
  },
  {
    "objectID": "chapters/preparing.html#checkpoint",
    "href": "chapters/preparing.html#checkpoint",
    "title": "4  Preparing the data",
    "section": "4.4 Checkpoint",
    "text": "4.4 Checkpoint\n\nsave summarized data and pivotted data."
  },
  {
    "objectID": "chapters/plotting.html",
    "href": "chapters/plotting.html",
    "title": "5  Plotting",
    "section": "",
    "text": "In this section we will show how to explore qPCR data through plotting. Whenever doing data analysis, it is very important to explore data through data summaries and plots. This way you learn and get a better feeling for the generated data. Moreover, it is a great way to discover outliers."
  },
  {
    "objectID": "chapters/plotting.html#section",
    "href": "chapters/plotting.html#section",
    "title": "5  Plotting",
    "section": "5.1 ",
    "text": "5.1"
  }
]